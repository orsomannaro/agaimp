"""
Subclass of Paramenters, which is generated by wxFormBuilder.
"""

import wx

from gui.agaimparam_form import ParametersForm


class EditParamsView(ParametersForm):
    """ Edit parametri tramite form.
    """
    def __init__(self, parent, params_obj):
        """
        :param params_obj: istanza della classe LocalParam
        """
        ParametersForm.__init__(self, parent)
        self.params_obj = params_obj
        self.Bind(wx.EVT_SHOW, self.OnShow)  # gestione evento Show
        self.Show()

    def OnCancelClick(self, event):
        self.Close()

    def OnSaveClick(self, event):
        """ Salva i parametri.
        """
        #TODO: i valori dei parametri devono essere validati prima di salvarli
        params = self.params_obj.params()
        for name in params.keys():
            if name in self.__dict__.keys():
                value = self.__dict__[name].Value
                params[name] = value
        self.params_obj.save()
        self.Close()

    def OnShow(self, event):
        """ Carica i parametri.
        """
        if event.Show:
            params = self.params_obj.params()
            for key, value in params.items():
                if key in self.__dict__.keys():
                    self.__dict__[key].Value = value
